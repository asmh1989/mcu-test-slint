import { Button, LineEdit, VerticalBox, HorizontalBox, TextEdit, ScrollView, StandardTableView } from "std-widgets.slint";

export component FileOperationPanel inherits Rectangle {
    in-out property <string> file-status-text: "请选择文件...";
    in-out property <brush> file-status-color: #6c757d; // 默认灰色
    in-out property <string> read-file-button-text: "读取文件";
    in-out property <string> read-device-button-text: "读取器件";
    in-out property <string> config-file-button-text: "配置器件";
    in-out property <string> file-content-label: "寄存器地址与参数表";
    in-out property <string> file-content: "";
    
    // 新增表格数据属性
    in-out property <[[StandardListViewItem]]> table-data: [];
    in-out property <[TableColumn]> table-columns: [
        { title: "页地址", min-width: 80px, horizontal-stretch: 1 },
        { title: "寄存器", min-width: 120px, horizontal-stretch: 2 },
        { title: "读写", min-width: 60px, horizontal-stretch: 0.5 },
        { title: "值", min-width: 80px, horizontal-stretch: 1 },
        { title: "写入值", min-width: 80px, horizontal-stretch: 1 },
    ];
    callback read-file-clicked();
    callback read-device-clicked();
    callback write-device-clicked();
    border-radius: 12px;
    border-width: 2px;
    border-color: #d0d0d0;
    background: #f8f9fa;
    drop-shadow-blur: 4px;
    drop-shadow-color: #00000020;
    VerticalBox {
        padding: 16px;
        spacing: 16px;

        // 上部分：文件状态显示（高度较小）
        Rectangle {
            height: 40px;
            border-radius: 8px;
            border-width: 1px;
            border-color: #e0e0e0;
            background: #ffffff;
            HorizontalBox {
                padding: 8px;
                alignment: center;
                Text {
                    text: file-status-text;
                    color: file-status-color;
                    font-size: 14px;
                    font-weight: 500;
                    horizontal-alignment: left;
                    vertical-alignment: center;
                }
            }
        }

        // 下部分：左右布局
        HorizontalBox {
            spacing: 6px;
            
            // 左侧：三个按钮垂直排列
            VerticalBox {
                spacing: 40px;
                Button {
                    text: read-file-button-text;
                    preferred-height: 48px;
                    clicked => {
                        read-file-clicked();
                    }
                }

                Button {
                    text: read-device-button-text;
                    preferred-height: 48px;
                    clicked => {
                        read-device-clicked();
                    }
                }

                Button {
                    text: config-file-button-text;
                    preferred-height: 48px;
                    clicked => {
                        write-device-clicked();
                    }
                }
            }

            // 右侧：大框显示内容
            VerticalBox {
                horizontal-stretch: 1;
                spacing: 8px;
                Text {
                    text: file-content-label;
                    color: #495057;
                    font-size: 16px;
                    font-weight: 600;
                }

                Rectangle {
                    border-radius: 8px;
                    border-width: 1px;
                    border-color: #e0e0e0;
                    background: #ffffff;
                    min-height: 200px;
                    vertical-stretch: 1;
                    drop-shadow-blur: 2px;
                    drop-shadow-color: #00000010;
                    padding: 4px;
                    StandardTableView {
                        height: parent.height - 8px; // 减去padding
                        width: parent.width - 8px; // 减去padding
                        columns: table-columns;
                        rows: table-data;
                    }
                }
            }
        }
    }
}
